type DealtAmount inherits Money
type SettlementAmount inherits Money
type alias CustomerId as String

type Money {
   quantity : Decimal
   currency : CurrencySymbol as String
}

type CsvTradeRecord {
    counterparty : CustomerId by column(1)
    ccy1 : CurrencySymbol by column(2)
    ccy2 : CurrencySymbol by column(4)
    quotedCurrency : CurrencySymbol by column(7)
    (   dealtAmount : DealtAmount
        settlementAmount : SettlementAmount
    ) by when ( this.quotedCurrency ) {
        ccy1 -> {
            dealtAmount(
                quantity by column(3)
                currency = ccy1
            )
            settlementAmount(
                quantity by column(5)
                currency = ccy2
            )
        }
        ccy2 -> {
        dealtAmount(
                quantity by column(6)
                currency = ccy2
            )
            settlementAmount(
                quantity by column(3)
                currency = ccy1
            )
        }
    }
}

@CsvList
type alias CsvTradeRecordList as CsvTradeRecord[]
